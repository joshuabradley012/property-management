var oldData = JSON.parse('{"1202 Colorado Boulevard":{"accounts":{"-LlHhc_Z3JhN0idVsg8J":{"amount": 29000,"date": "2019-08-01","id": "-LlHhc_Z3JhN0idVsg8J","logType": "Expense","name": "Frenchwood - Colorado Window Deposit","reoccuring": false,"type": "Repairs and Maintenance"},"-Llaq5b04x1fjxqCqd1l":{"amount": 1144.5,"date": "2019-08-05","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"},"-Llb4qCnjFWw1arEXh1L":{"amount": 462,"date": "2019-08-06","logType": "Expense","name": "Point Blank Electric- 1208 & 1212 comonthon area electric","reoccuring": false,"type": "Repairs and Maintenance"},"-Llfy0QzQJ84YW4t4fmM":{"amount": 681.24,"date": "2019-08-07","id": "-Llfy0QzQJ84YW4t4fmM","logType": "Expense","name": "LADBS Window Permit Check 1006","reoccuring": false,"type": "Repairs and Maintenance"},"-LmMAdF89zJmuncxYbub":{"amount": 6500,"date": "2019-08-10","logType": "Expense","name": "Vickie Nigra","reoccuring": false,"type": "Owner Draw"},"-LnmlDiIYw2rpEcCFLhi":{"amount": 5000,"date": "2019-08-15","logType": "Expense","name": "Vickie Nigra","reoccuring": false,"type": "Owner Draw  Check 1030"},"-LoBTPPNQgYKMrXlSi05":{"amount": 13000,"date": "2019-09-07","logType": "Expense","name": "Steve Lindhal - windows","reoccuring": false,"type": "Repairs and Maintenance"},"-LoFytl-gI23zWsjqvKx":{"amount": 1146.3,"date": "2019-09-08","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"},"-LpxD8LgNAQF9_hDxoch":{"amount": 7000,"chargeTenants": false,"date": "2019-09-29","logType": "Expense","name": "Vickie Nigra","reoccuring": false,"type": "Owner draw"},"-LqCpSLg5SJU0XLGHpEU":{"amount": 9000,"chargeTenants": false,"date": "2019-10-02","id": "-LqCpSLg5SJU0XLGHpEU","logType": "Expense","name": "Frenchwood","reoccuring": false,"type": "Repairs and Maintenance"},"-LqiL67EQHhKlb8qI8r8":{"amount": 1147.5,"chargeTenants": false,"date": "2019-10-08","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"},"-LqkYujOxZzbljahMrGq":{"amount": 3000,"date": "2019-10-02","logType": "Revenue","name": "To cover window expenses","reoccuring": false,"type": "Loan from owner"},"-LsXdlMRPe1rty8ASG3J":{"amount": 5851.92,"chargeTenants": false,"date": "2019-10-31","logType": "Expense","name": "Frenchwood","reoccuring": false,"type": "Repairs and Maintenance"},"-Lt0Ez-Jt_NK9DhAFYMY":{"amount": 6000,"chargeTenants": false,"date": "2019-10-31","logType": "Expense","name": "Owner Draw","reoccuring": false,"type": "Misc."},"-Lt1OiHUGe_f_I2kI18l":{"amount": 1148.04,"chargeTenants": false,"date": "2019-11-06","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"},"-LuYvfrCcUREhTGxyOuG":{"amount": 1487,"chargeTenants": false,"date": "2019-11-25","logType": "Expense","name": "Frenchwood windows","reoccuring": false,"type": "Repairs and Maintenance"},"-LvqrSUCq6j10uBB38sS":{"amount": 320,"chargeTenants": false,"date": "2019-12-11","logType": "Expense","name": "1202-2 holes in bathroom and sink","reoccuring": false,"type": "Repairs and Maintenance"},"-LvqrcVOnq5hWyq2KcZR":{"amount": 330,"chargeTenants": false,"date": "2019-12-11","logType": "Expense","name": "1202 exterior and 1202-2 tile","reoccuring": false,"type": "Repairs and Maintenance"},"-LvqrzDFJmKjk8MBzfpM":{"amount": 1143.96,"chargeTenants": false,"date": "2019-12-10","logType": "Expense","name": "Rebecca Themelis - December management","reoccuring": false,"type": "Property Management"},"-LxajeW13FptYI8Dzz6V":{"amount": 280,"chargeTenants": false,"date": "2020-01-02","logType": "Expense","name": "Indian chief fire co","reoccuring": false,"type": "Repairs and Maintenance"},"-LxxjVlwu6U7aXI6KhZo":{"amount": 990.84,"chargeTenants": false,"date": "2020-01-06","id": "-LxxjVlwu6U7aXI6KhZo","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198946621.jpg?alt=media&token=112ab8aa-e367-43ff-9c35-fe0abc613c4d","state": "CA"},"payments":{"-LjplWPka1rgc2w_mnCG":{"2019-07-05": 857,"2019-08-05": 857,"2019-09-07": 857,"2019-10-07": 857,"2019-11-05": 857,"2019-12-06": 857,"2020-01-06": 857,"2020-02-06": 891},"-LjplfMCl850Adm9byHE":{"2019-07-05": 868,"2019-08-05": 868,"2019-09-07": 868,"2019-10-07": 868,"2019-11-05": 868,"2019-12-06": 868,"2020-01-06": 868,"2020-02-06": 902},"-LjploPkP6uBjJgqQSiE":{"2019-07-05": 833,"2019-08-01": 833,"2019-09-05": 833,"2019-10-02": 833,"2019-11-05": 833,"2019-12-06": 833,"2020-01-06": 833,"2020-02-06": 866},"-LjplzMDH5A5b2r6qdaF":{"2019-07-05": 1045,"2019-08-05": 1045,"2019-09-05": 1045,"2019-10-07": 1045,"2019-11-05": 1045,"2019-12-01": 1045,"2020-01-06": 1045,"2020-02-06": 1086}},"paymentsInfo":{"-LjplWPka1rgc2w_mnCG":{"2019-09-07":{"description": "426","source": "Check"},"2019-10-07":{"description": "427","source": "Check"},"2019-11-05":{"description": "428","source": "Check"},"2019-12-06":{"description": "430","source": "Check"},"2020-01-06":{"description": "431","source": "Check"},"2020-02-06":{"description": "432","source": "Check"}},"-LjplfMCl850Adm9byHE":{"2019-09-07":{"description": "315","source": "Check"},"2019-10-07":{"description": "316","source": "Check"},"2019-11-05":{"description": "317","source": "Check"},"2019-12-06":{"description": "318","source": "Check"},"2020-01-06":{"description": "319","source": "Check"},"2020-02-06":{"description": "320","source": "Check"}},"-LjploPkP6uBjJgqQSiE":{"2019-09-05":{"description": "833","source": "Check"},"2019-10-02":{"description": "1578","source": "Check"},"2019-11-05":{"description": "1582","source": "Check"},"2019-12-06":{"description": "3641","source": "Check"},"2020-01-06":{"description": "3645","source": "Check"},"2020-02-06":{"description": "3650","source": "Check"}},"-LjplzMDH5A5b2r6qdaF":{"2019-09-05":{"description": "2568","source": "Check"},"2019-10-07":{"source": "Check"},"2019-11-05":{"description": "2579","source": "Check"},"2020-01-06":{"description": "2589","source": "Check"},"2020-02-06":{"description": "2594","source": "Check"}}},"residents":{"-LjplWPka1rgc2w_mnCG":{"address": "1202 Colorado Boulevard","city": "Los Angeles","email": "n/a","id": "-LjplWPka1rgc2w_mnCG","lease end": "2020-06-17","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$857","name": "Jessie Sanchez","phone": "323-353-0556","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 857}},"December":{"rent":{"total": 857}},"July":{"rent":{"total": 857}},"November":{"rent":{"total": 857}},"October":{"rent":{"total": 857}},"September":{"rent":{"total": 857}}},"2020":{"April":{"rent":{"total": 891}},"February":{"rent":{"total": 891}},"January":{"rent":{"total": 857}},"June":{"rent":{"total": 891}},"March":{"rent":{"total": 891}},"May":{"rent":{"total": 891}}}},"state": "CA","uid": "i4uXnDyOaOfHdrl1b0mvLdFms7J2","unit": "1"},"-LjplfMCl850Adm9byHE":{"address": "1202 Colorado Boulevard","city": "Los Angeles","email": "rossmerymar@hotmail.com","id": "-LjplfMCl850Adm9byHE","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-LjplfMCl850Adm9byHE","monthlyRent": "$868","name": "Rosa Alvarez","phone": "323-400-7466","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 868}},"December":{"rent":{"total": 868}},"July":{"rent":{"total": 868}},"November":{"rent":{"total": 868}},"October":{"rent":{"total": 868}},"September":{"rent":{"total": 868}}},"2020":{"April":{"rent":{"total": 902}},"February":{"rent":{"total": 902}},"January":{"rent":{"total": 868}},"June":{"rent":{"total": 902}},"March":{"rent":{"total": 902}},"May":{"rent":{"total": 902}}}},"state": "CA","unit": "2"},"-LjploPkP6uBjJgqQSiE":{"address": "1202 Colorado Boulevard","city": "Los Angeles","email": "sonialopez1202@gmail.com","id": "-LjploPkP6uBjJgqQSiE","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$833","name": "Sonia Lopez","phone": "323-868-2376","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 833}},"December":{"rent":{"total": 833}},"July":{"rent":{"total": 833}},"November":{"rent":{"total": 833}},"October":{"rent":{"total": 833}},"September":{"rent":{"total": 833}}},"2020":{"April":{"rent":{"total": 866}},"February":{"rent":{"total": 866}},"January":{"rent":{"total": 833}},"June":{"rent":{"total": 866}},"March":{"rent":{"total": 866}},"May":{"rent":{"total": 866}}}},"state": "CA","uid": "Sz3o5mUCuZRWVF3Qtfgn5cTcaUy2","unit": "3"},"-LjplzMDH5A5b2r6qdaF":{"address": "1202 Colorado Boulevard","city": "Los Angeles","email": "leahrmadallanes@att.net","id": "-LjplzMDH5A5b2r6qdaF","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1045","name": "Leah Magellanes","phone": "323-356-1598","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1045}},"December":{"rent":{"total": 1045}},"July":{"rent":{"total": 1045}},"November":{"rent":{"total": 1045}},"October":{"rent":{"total": 1045}},"September":{"rent":{"total": 1045}}},"2020":{"April":{"rent":{"total": 1086}},"February":{"rent":{"total": 1086}},"January":{"rent":{"total": 1045}},"June":{"rent":{"total": 1086}},"March":{"rent":{"total": 1086}},"May":{"rent":{"total": 1086}}}},"state": "CA","uid": "IvkWLNWfUoZshPEzgLscebJOoSs2","unit": "4"}}},"1208 Colorado Boulevard":{"accounts":{"-Lo2jLxz8_jILuVIutsw":{"amount": 30,"date": "2019-09-06","logType": "Fee","name": "Kevin Simon","reoccuring": false,"type": "Late fee"},"-LoCNz2gRQ6VhXshZong":{"amount": 30,"date": "2019-09-07","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Misc."},"-M-S8BbTAMt799YiB7a7":{"amount": 30,"chargeTenants": false,"date": "2020-02-06","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198920030.jpg?alt=media&token=ec6dc10b-e22e-408d-87e3-a64caeefd232","state": "CA"},"payments":{"-LjppG5b_FsjS5VP6J5W":{"2019-07-05": 1123,"2019-08-02": 1123,"2019-09-05": 1123,"2019-10-02": 1123,"2019-11-05": 1123,"2019-12-06": 1123,"2020-01-06": 1123,"2020-02-06": 1167},"-LjppN8HWitbvElUnA8_":{"2019-07-05": 1012,"2019-08-05": 1012,"2019-09-07": 1042,"2019-10-07": 1012,"2019-11-06": 1012,"2019-12-06": 1012,"2020-01-06": 1012,"2020-02-07": 1082},"-LjppUgYezzYPJ6LXqik":{"2019-07-05": 1069,"2019-08-05": 1069,"2019-09-05": 1069,"2019-10-07": 1069,"2019-11-06": 1069,"2019-12-06": 1069,"2020-01-06": 1069,"2020-02-06": 1111},"-LjppdfT5yQ8WfHQWoSH":{"2019-07-05": 846,"2019-08-05": 846,"2019-09-05": 846,"2019-10-07": 846,"2019-11-05": 846,"2019-12-06": 846,"2020-01-06": 846,"2020-02-06": 879}},"paymentsInfo":{"-LjppG5b_FsjS5VP6J5W":{"2019-09-05":{"description": "189","source": "Check"},"2019-10-02":{"description": "190","source": "Check"},"2019-11-05":{"description": "101","source": "Check"},"2019-12-06":{"description": "102","source": "Check"},"2020-01-06":{"description": "103","source": "Check"},"2020-02-06":{"description": "104","source": "Check"}},"-LjppN8HWitbvElUnA8_":{"2019-09-07":{"description": "MO","source": "Other"},"2019-10-07":{"description": "3330","source": "Bank"},"2019-11-06":{"source": "Bank"},"2019-12-06":{"source": "Bank"},"2020-01-06":{"description": "Cashiers check","source": "Other"},"2020-02-07":{"description": "Money order","source": "Other"}},"-LjppUgYezzYPJ6LXqik":{"2019-09-05":{"description": "Money order","source": "Other"},"2019-10-07":{"description": "Mo","source": "Other"},"2019-11-06":{"source": "Bank"},"2019-12-06":{"description": "Money order","source": "Other"},"2020-01-06":{"description": "Money order","source": "Other"},"2020-02-06":{"description": "Money order","source": "Other"}},"-LjppdfT5yQ8WfHQWoSH":{"2019-09-05":{"description": "1023","source": "Check"},"2019-10-07":{"description": "1030","source": "Check"},"2019-11-05":{"description": "1042","source": "Check"},"2019-12-06":{"description": "1032","source": "Check"},"2020-01-06":{"description": "1033","source": "Check"},"2020-02-06":{"description": "1057","source": "Check"}}},"residents":{"-LjppG5b_FsjS5VP6J5W":{"address": "1208 Colorado Boulevard","city": "Los Angeles","email": "mn46292@gmail.com","id": "-LjppG5b_FsjS5VP6J5W","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1123","name": "Kathleen Dornidon","phone": "323-806-2720","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1123}},"December":{"rent":{"total": 1123}},"July":{"rent":{"total": 1123}},"November":{"rent":{"total": 1123}},"October":{"rent":{"total": 1123}},"September":{"rent":{"total": 1123}}},"2020":{"April":{"rent":{"total": 1167}},"February":{"rent":{"total": 1167}},"January":{"rent":{"total": 1123}},"June":{"rent":{"total": 1167}},"March":{"rent":{"total": 1167}},"May":{"rent":{"total": 1167}}}},"state": "CA","uid": "21dVTaKL4LWi8lkF3HKdSZgBg5B3","unit": "1"},"-LjppN8HWitbvElUnA8_":{"address": "1208 Colorado Boulevard","city": "Los Angeles","email": "mrsimonfilms@gmail.com","id": "-LjppN8HWitbvElUnA8_","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1012","name": "Kevin Simon","phone": "401-639-4952","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1012}},"December":{"rent":{"total": 1012}},"July":{"rent":{"total": 1012}},"November":{"rent":{"total": 1012}},"October":{"rent":{"total": 1012}},"September":{"adjustments":{"-LoCNz2gRQ6VhXshZong": "fee/revenue"},"rent":{"total": 1012}}},"2020":{"April":{"rent":{"total": 1052}},"February":{"adjustments":{"-M-S8BbTAMt799YiB7a7": "fee/revenue"},"rent":{"total": 1052}},"January":{"rent":{"total": 1012}},"June":{"rent":{"total": 1052}},"March":{"rent":{"total": 1052}},"May":{"rent":{"total": 1052}}}},"state": "CA","uid": "MUAfV6dKC7g9Xs8kUZ4orucdelk2","unit": "2"},"-LjppUgYezzYPJ6LXqik":{"address": "1208 Colorado Boulevard","city": "Los Angeles","email": "perezmiami72@yahoo.com","id": "-LjppUgYezzYPJ6LXqik","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-LjppUgYezzYPJ6LXqik","monthlyRent": "$1069","name": "Ricardo Perez","phone": "323-422-0063","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1069}},"December":{"rent":{"total": 1069}},"July":{"rent":{"total": 1069}},"November":{"rent":{"total": 1069}},"October":{"rent":{"total": 1069}},"September":{"rent":{"total": 1069}}},"2020":{"April":{"rent":{"total": 1111}},"February":{"rent":{"total": 1111}},"January":{"rent":{"total": 1069}},"June":{"rent":{"total": 1111}},"March":{"rent":{"total": 1111}},"May":{"rent":{"total": 1111}}}},"state": "CA","unit": "3"},"-LjppdfT5yQ8WfHQWoSH":{"address": "1208 Colorado Boulevard","city": "Los Angeles","email": "n/a","id": "-LjppdfT5yQ8WfHQWoSH","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-LjppdfT5yQ8WfHQWoSH","monthlyRent": "$846","name": "Mary Texidor","phone": "323-394-9010","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 846}},"December":{"rent":{"total": 846}},"July":{"rent":{"total": 846}},"November":{"rent":{"total": 846}},"October":{"rent":{"total": 846}},"September":{"rent":{"total": 846}}},"2020":{"April":{"rent":{"total": 879}},"February":{"rent":{"total": 879}},"January":{"rent":{"total": 846}},"June":{"rent":{"total": 879}},"March":{"rent":{"total": 879}},"May":{"rent":{"total": 879}}}},"state": "CA","unit": "4"}}},"1212 Colorado Boulevard":{"accounts":{"-LxvwgqrPfH5VT6SM8Y9":{"amount": 30,"chargeTenants": false,"date": "2020-01-06","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"},"-Lxww2AfzDJJThKUBVX5":{"amount": 9,"chargeTenants": false,"date": "2020-01-06","id": "-Lxww2AfzDJJThKUBVX5","logType": "Concession","name": "Rent overpayment","reoccuring": false,"type": "Reimbursement"},"-LxwwVOsW2sbWcnM69Ra":{"amount": 9,"chargeTenants": false,"date": "2020-01-06","logType": "Expense","name": "Maria rousey","reoccuring": false,"type": "Overpayment refund"},"-LyL5-JbYj4DptZ2TaNr":{"amount": 9,"chargeTenants": false,"date": "2020-01-06","logType": "Fee","name": "rent overpayment","reoccuring": false,"type": "Misc."},"-LyL6yeWlBoXh8-UZZt8":{"amount": 9,"chargeTenants": false,"date": "2020-01-06","logType": "Fee","name": "rent overpayment","reoccuring": false,"type": "Misc."},"-LyL82X4zdlHXv7iiIp2":{"amount": -9,"chargeTenants": false,"date": "2020-01-06","logType": "Concession","name": "Rent overpayment","reoccuring": false,"type": "Misc."},"-M-S8MlpdPCZTUzjtPMy":{"amount": 30,"chargeTenants": false,"date": "2020 - 02 - 06","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198976649.jpg?alt=media&token=d261a948-6d77-48b6-908a-e0a8d590f3d6","state": "CA"},"payments":{"-Ljppre-E85Bt93FSVkF":{"2019-07-05": 1591,"2019-08-02": 1591,"2019-09-01": 1591,"2019-10-01": 1591,"2019-11-01": 1591,"2019-12-01": 1591,"2020-01-01": 1591,"2020-02-01": 1654},"-LjppzaBPBTJZUW2vAdO":{"2019-07-05": 1221,"2019-08-06": 1221,"2019-09-05": 1221,"2019-10-07": 1221,"2019-11-06": 1221,"2019-12-06": 1221,"2020-01-06": 1221,"2020-02-07": 1299},"-Ljpq6be5eEFxAyZF2yh":{"2019-07-05": 1306,"2019-08-05": 1306,"2019-09-03": 1306,"2019-10-01": 1306,"2019-11-01": 1306,"2019-12-03": 1306,"2020-01-05": 1306,"2020-02-03": 1358},"-LjpqE30ecCcg_5-7LUZ":{"2019-07-05": 1021,"2019-08-05": 1021,"2019-09-05": 1021,"2019-10-07": 1021,"2019-11-06": 1030,"2019-12-06": 1012,"2020-01-11": 1051,"2020-02-06": 1061}},"paymentsInfo":{"-LjppzaBPBTJZUW2vAdO":{"2019-09-05":{"description": "126","source": "Check"},"2019-10-07":{"description": "1221","source": "Check"},"2019-11-06":{"source": "Check"},"2019-12-06":{"description": "180","source": "Check"},"2020-01-06":{"description": "181","source": "Check"},"2020-02-07":{"source": "Check"}},"-LjpqE30ecCcg_5-7LUZ":{"2019-09-05":{"description": "Money order","source": "Other"},"2019-10-07":{"source": "Bank"},"2019-11-06":{"source": "Check"},"2019-12-06":{"description": "3206","source": "Check"},"2020-01-06":{"description": "3216"},"2020-01-11":{"source": "Check"},"2020-02-06":{"description": "3173.4","source": "Check"}}},"residents":{"-Ljppre-E85Bt93FSVkF":{"address": "1212 Colorado Boulevard","city": "Los Angeles","email": "miamag_443@msn.com","id": "-Ljppre-E85Bt93FSVkF","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1591","name": "Mia Hernandez","phone": "818-572-3332","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1591}},"December":{"rent":{"total": 1591}},"July":{"rent":{"total": 1591}},"November":{"rent":{"total": 1591}},"October":{"rent":{"total": 1591}},"September":{"rent":{"total": 1591}}},"2020":{"April":{"rent":{"total": 1654}},"February":{"rent":{"total": 1654}},"January":{"rent":{"total": 1591}},"June":{"rent":{"total": 1654}},"March":{"rent":{"total": 1654}},"May":{"rent":{"total": 1654}}}},"state": "CA","uid": "CY9oU1rBMTO6C3sS2h9TbiWZHvb2","unit": "1"},"-LjppzaBPBTJZUW2vAdO":{"address": "1212 Colorado Boulevard","city": "Los Angeles","email": "byron4578@gmail.com","id": "-LjppzaBPBTJZUW2vAdO","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1221","name": "Byron Sanchez","phone": "818-653-2488","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1221}},"December":{"rent":{"total": 1221}},"July":{"rent":{"total": 1221}},"November":{"rent":{"total": 1221}},"October":{"rent":{"total": 1221}},"September":{"rent":{"total": 1221}}},"2020":{"April":{"rent":{"total": 1269}},"February":{"adjustments":{"-M-S8MlpdPCZTUzjtPMy": "fee/revenue"},"rent":{"total": 1269}},"January":{"rent":{"total": 1221}},"June":{"rent":{"total": 1269}},"March":{"rent":{"total": 1269}},"May":{"rent":{"total": 1269}}}},"state": "CA","uid": "wMRia538oWcNxifcmFO0FbOecoz2","unit": "2"},"-Ljpq6be5eEFxAyZF2yh":{"address": "1212 Colorado Boulevard","city": "Los Angeles","email": "vindyduran@gmail.com","id": "-Ljpq6be5eEFxAyZF2yh","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1306","name": "Vindy Duran","phone": "323-514-6687","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1306}},"December":{"rent":{"total": 1306}},"July":{"rent":{"total": 1306}},"November":{"rent":{"total": 1306}},"October":{"rent":{"total": 1306}},"September":{"rent":{"total": 1306}}},"2020":{"April":{"rent":{"total": 1358}},"February":{"rent":{"total": 1358}},"January":{"rent":{"total": 1306}},"June":{"rent":{"total": 1358}},"March":{"rent":{"total": 1358}},"May":{"rent":{"total": 1358}}}},"state": "CA","uid": "B2ODV7bShIgdniHoa4bVoVTcznN2","unit": "3"},"-LjpqE30ecCcg_5-7LUZ":{"address": "1212 Colorado Boulevard","city": "Los Angeles","email": "maria.rousey16@yahoo.com","id": "-LjpqE30ecCcg_5-7LUZ","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-LjpqE30ecCcg_5-7LUZ","monthlyRent": "$1021","name": "Corbett and Maria Rousey","phone": "626-429-3475","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1021}},"December":{"rent":{"total": 1012}},"July":{"rent":{"total": 1021}},"November":{"rent":{"total": 1030}},"October":{"rent":{"total": 1021}},"September":{"rent":{"total": 1021}}},"2020":{"April":{"rent":{"total": 1061}},"February":{"rent":{"total": 1061}},"January":{"adjustments":{"-LxvwgqrPfH5VT6SM8Y9": "fee/revenue","-LyL82X4zdlHXv7iiIp2": "fee/revenue"},"rent":{"total": 1012}},"June":{"rent":{"total": 1061}},"March":{"rent":{"total": 1061}},"May":{"rent":{"total": 1061}}}},"state": "CA","unit": "4"}}},"1216 Colorado Boulevard":{"accounts":{"-LqCphidmfsegAXQa8Qg":{"amount": 60,"chargeTenants": false,"date": "2019-10-02","id": "-LqCphidmfsegAXQa8Qg","logType": "Expense","name": "Leo -  hinge repair","reoccuring": false,"type": "Repairs and Maintenance"},"-Lqan5mcdj8hDZLwz3Xt":{"amount": 50,"chargeTenants": false,"date": "2019-10-07","id": "-Lqan5mcdj8hDZLwz3Xt","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"},"-LqanwRrKBrpCB5sdYOx":{"amount": 20,"chargeTenants": false,"date": "2019-10-07","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"},"-LsyquA8bhw964tK6E7-":{"amount": 50,"chargeTenants": false,"date": "2019-11-05","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Misc."},"-LvSZKOLgKROI9sWgmlB":{"amount": 50,"chargeTenants": false,"date": "2019-12-06","logType": "Fee","name": "Late fee","reoccuring": false,"type": "Late fee"},"manualFee":{"amount": 50,"chargeTenants": false,"date": "2020-01-01","logType": "Fee","name": "late fee","reoccuring": false,"type": "late fee"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198874185.jpg?alt=media&token=e75e8445-f7ae-4221-8a4d-cd2ba4cc1022","state": "CA"},"payments":{"-LjpqNy1BPXXhW4fT3oS":{"2019-07-05": 1872,"2019-08-05": 1872,"2019-09-04": 1872,"2019-10-07": 1922,"2019-11-06": 1922,"2019-12-30": 1922,"2020-01-01": 1872,"2020-02-05": 1872},"-LjpqY-0yzkkbMPAqg_E":{"2019-07-05": 1820,"2019-08-05": 1820,"2019-09-05": 1820,"2019-10-02": 1820,"2019-11-05": 1820,"2019-12-06": 1820,"2020-01-06": 1820,"2020-02-06": 1820}},"paymentsInfo":{"-LjpqNy1BPXXhW4fT3oS":{"2019-12-30":{"description": "mobile","source": "Other"},"2020-01-01":{"description": "credit card","source": "Other"}},"-LjpqY-0yzkkbMPAqg_E":{"2019-09-05":{"description": "1820","source": "Check"},"2019-10-02":{"description": "127","source": "Check"},"2019-11-05":{"description": "129","source": "Check"},"2019-12-06":{"description": "131","source": "Check"},"2020-01-06":{"description": "132","source": "Check"},"2020-02-06":{"description": "133","source": "Check"}}},"residents":{"-LjpqNy1BPXXhW4fT3oS":{"address": "1216 Colorado Boulevard","city": "Los Angeles","email": "joellebrooks01@gmail.com","id": "-LjpqNy1BPXXhW4fT3oS","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1872","name": "Brooke Morgan","phone": "909-354-1000","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1872}},"December":{"adjustments":{"-LvSZKOLgKROI9sWgmlB": "fee/revenue"},"rent":{"total": 1872}},"July":{"rent":{"total": 1872}},"November":{"adjustments":{"-LsyquA8bhw964tK6E7-": "fee/revenue"},"rent":{"total": 1872}},"October":{"adjustments":{"-Lqan5mcdj8hDZLwz3Xt": "fee/revenue"},"rent":{"total": 1872}},"September":{"rent":{"total": 1872}}},"2020":{"April":{"rent":{"total": 1872}},"February":{"rent":{"total": 1872}},"January":{"rent":{"total": 1872}},"June":{"rent":{"total": 1872}},"March":{"rent":{"total": 1872}},"May":{"rent":{"total": 1872}}}},"state": "CA","uid": "EKRH5hfaZPcubvsUODAo91Xilm23","unit": "1"},"-LjpqY-0yzkkbMPAqg_E":{"address": "1216 Colorado Boulevard","city": "Los Angeles","email": "tbone8552@yahoo.com","id": "-LjpqY-0yzkkbMPAqg_E","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-LjpqY-0yzkkbMPAqg_E","monthlyRent": "$1820","name": "Javier Garcia","phone": "562-832-5803","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1820}},"December":{"rent":{"total": 1820}},"July":{"rent":{"total": 1820}},"November":{"rent":{"total": 1820}},"October":{"rent":{"total": 1820}},"September":{"rent":{"total": 1820}}},"2020":{"April":{"rent":{"total": 1820}},"February":{"rent":{"total": 1820}},"January":{"rent":{"total": 1820}},"June":{"rent":{"total": 1820}},"March":{"rent":{"total": 1820}},"May":{"rent":{"total": 1820}}}},"state": "CA","unit": "2"}}},"3201 Orilla Avenue":{"accounts":{"-LxxjhVnk40vLkgPhIm8":{"amount": 80.58,"chargeTenants": false,"date": "2020-01-06","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198846306.jpg?alt=media&token=0e952df7-1fc0-4620-abd5-ac8a68f7b32a","state": "CA"},"payments":{"-LjpmAhX73Iro2uEUd33":{"2019-07-05": 1343,"2019-08-03": 1343,"2019-09-03": 1343,"2019-10-03": 1343,"2019-11-04": 1343,"2019-12-05": 1343,"2020-01-03": 1343,"2020-02-04": 1396}},"residents":{"-LjpmAhX73Iro2uEUd33":{"address": "3201 Orilla Avenue","city": "Los Angeles","email": "rondacova@yahoo.com","id": "-LjpmAhX73Iro2uEUd33","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$1343","name": "Ronda Covarrubias","phone": "818-669-4443","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1343}},"December":{"rent":{"total": 1343}},"July":{"rent":{"total": 1343}},"November":{"rent":{"total": 1343}},"October":{"rent":{"total": 1343}},"September":{"rent":{"total": 1343}}},"2020":{"April":{"rent":{"total": 1396}},"February":{"rent":{"total": 1396}},"January":{"rent":{"total": 1343}},"June":{"rent":{"total": 1396}},"March":{"rent":{"total": 1396}},"May":{"rent":{"total": 1396}}}},"state": "CA","uid": "xfHJPmhQ0gQJYC3brLXaQi9EbMt2"}}},"3969 Denker Ave":{"accounts":{"-LlHiMfsRHeQi8xSME_Q":{"amount": 30,"date": "2019-08-02","logType": "Expense","name": "Pest Control","reoccuring": false,"type": "Repairs and Maintenance"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198767803.jpg?alt=media&token=65ec61a4-8284-4849-b447-a1a45cab2c4b","state": "CA"},"connect": "acct_1Ezlp8INwHpKPJ3K","payments":{"-Ljpmb9FBAeGzqYtZZnu":{"2019-07-05": 1653,"2019-08-01": 1653,"2019-09-05": 1653,"2019-10-07": 1653,"2019-11-04": 1653,"2019-12-05": 1653,"2020-01-04": 1653,"2020-02-04": 1653},"-Ljpoat2TifVHNRBfWOv":{"2019-07-05": 2400,"2019-08-05": 2400,"2019-09-05": 2400,"2019-10-04": 2400,"2019-11-04": 2400,"2019-12-05": 2400,"2020-01-07": 2400,"2020-02-07": 2400},"-LjpooIEekjbt9INqJGc":{"2019-08-02": 0},"-Ljpp2DwJutrGz83wjC6":{"2019-07-05": 1606,"2019-08-01": 1606,"2019-09-11": 1606,"2019-10-04": 1606,"2019-11-04": 1606,"2019-12-05": 1606,"2020-01-04": 1606,"2020-02-07": 1606}},"paymentsInfo":{"-Ljpmb9FBAeGzqYtZZnu":{"2019-09-05":{"source": "Check"},"2019-10-07":{"source": "Check"},"2019-11-04":{"source": "Check"},"2019-12-05":{"source": "Check"},"2020-01-04":{"source": "Check"},"2020-02-04":{"source": "Check"}},"-Ljpoat2TifVHNRBfWOv":{"2019-09-05":{"source": "Check"},"2019-10-04":{"source": "Check"},"2019-11-04":{"source": "Check"},"2019-12-05":{"source": "Check"},"2020-01-07":{"source": "Check"},"2020-02-07":{"source": "Check"}},"-Ljpp2DwJutrGz83wjC6":{"2019-09-11":{"source": "Check"},"2019-10-04":{"source": "Check"},"2019-11-04":{"source": "Check"},"2019-12-05":{"source": "Check"},"2020-01-04":{"source": "Check"},"2020-02-07":{"source": "Check"}}},"residents":{"-Ljpmb9FBAeGzqYtZZnu":{"address": "3969 Denker Ave","city": "Los Angeles","email": "selenegarcia1986@gmail.com","id": "-Ljpmb9FBAeGzqYtZZnu","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-Ljpmb9FBAeGzqYtZZnu","monthlyRent": "$1653","name": "Selene Garcia","phone": "323-458-2857","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1653}},"December":{"rent":{"total": 1653}},"July":{"rent":{"total": 1653}},"November":{"rent":{"total": 1653}},"October":{"rent":{"total": 1653}},"September":{"rent":{"total": 1653}}},"2020":{"April":{"rent":{"total": 1653}},"February":{"rent":{"total": 1653}},"January":{"rent":{"total": 1653}},"June":{"rent":{"total": 1653}},"March":{"rent":{"total": 1653}},"May":{"rent":{"total": 1653}}}},"state": "CA","unit": "1"},"-Ljpoat2TifVHNRBfWOv":{"address": "3969 Denker Ave","city": "Los Angeles","email": "lilwegerer@yahoo.com","id": "-Ljpoat2TifVHNRBfWOv","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189p","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$2400","name": "Daniel Wegerer","phone": "310-425-4392","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 2400}},"December":{"rent":{"total": 2400}},"July":{"rent":{"total": 2400}},"November":{"rent":{"total": 2400}},"October":{"rent":{"total": 2400}},"September":{"rent":{"total": 2400}}},"2020":{"April":{"rent":{"total": 2400}},"February":{"rent":{"total": 2400}},"January":{"rent":{"total": 2400}},"June":{"rent":{"total": 2400}},"March":{"rent":{"total": 2400}},"May":{"rent":{"total": 2400}}}},"state": "CA","uid": "XZEt9s14JSVmbJDRgEAHPpssj7C3","unit": "2"},"-LjpooIEekjbt9INqJGc":{"address": "3969 Denker Ave","city": "Los Angeles","email": "rthemelis@gmail.com","id": "-LjpooIEekjbt9INqJGc","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "yes","monthlyRent": "$0","name": "Rebecca Themelis","phone": "310-494-6036","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 0}},"December":{"rent":{"total": 0}},"July":{"rent":{"total": 0}},"November":{"rent":{"total": 0}},"October":{"rent":{"total": 0}},"September":{"rent":{"total": 0}}},"2020":{"April":{"rent":{"total": 0}},"February":{"rent":{"total": 0}},"January":{"rent":{"total": 0}},"June":{"rent":{"total": 0}},"March":{"rent":{"total": 0}},"May":{"rent":{"total": 0}}}},"state": "CA","uid": "N4HCmFMSMJRaNaXlv0pnpROS3n63","unit": "3"},"-Ljpp2DwJutrGz83wjC6":{"address": "3969 Denker Ave","city": "Los Angeles","email": "tlsandness@gmail.com","id": "-Ljpp2DwJutrGz83wjC6","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","mobile": "-Ljpp2DwJutrGz83wjC6","monthlyRent": "$1606","name": "Tyler Sandness","phone": "310-721-0703","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1606}},"December":{"rent":{"total": 1606}},"July":{"rent":{"total": 1606}},"November":{"rent":{"total": 1606}},"October":{"rent":{"total": 1606}},"September":{"rent":{"total": 1606}}},"2020":{"April":{"rent":{"total": 1606}},"February":{"rent":{"total": 1606}},"January":{"rent":{"total": 1606}},"June":{"rent":{"total": 1606}},"March":{"rent":{"total": 1606}},"May":{"rent":{"total": 1606}}}},"state": "CA","unit": "4"}}},"4539 Verdugo Road":{"accounts":{"-Lvqr4ZKIY760goal_QL":{"amount": 160,"chargeTenants": false,"date": "2019-12-11","logType": "Expense","name": "Leo Santoyo","reoccuring": false,"type": "Repairs and Maintenance"},"-LxxjrcTTG2lVh-H32Gd":{"amount": 74.88,"chargeTenants": false,"date": "2020-01-06","logType": "Expense","name": "Rebecca Themelis","reoccuring": false,"type": "Property Management"}},"building":{"city": "Los Angeles","image": "https://firebasestorage.googleapis.com/v0/b/ryan-915d2.appspot.com/o/1563198706254.jpg?alt=media&token=6a1635ef-d197-47ae-8620-8c47b85acad0","state": "CA"},"payments":{"-LjpmND-Zfw8tPIUGAt2":{"2019-07-05": 1248,"2019-08-01": 1248,"2019-09-02": 1248,"2019-10-01": 1248,"2019-11-01": 1248,"2019-12-13": 1248,"2020-01-01": 1248,"2020-02-01": 1248}},"residents":{"-LjpmND-Zfw8tPIUGAt2":{"city": "Los Angeles","email": "candygirl587@hotmail.com","id": "-LjpmND-Zfw8tPIUGAt2","lease end": "2020-07-01","lease link": "https://getrentroom.com/?page_id=3189","lease start": "2019-07-01","monthlyRent": "$1248","name": "Candice Nigra","phone": "818-326-2810","price": 0,"rentHistory":{"2019":{"August":{"rent":{"total": 1248}},"December":{"rent":{"total": 1248}},"July":{"rent":{"total": 1248}},"November":{"rent":{"total": 1248}},"October":{"rent":{"total": 1248}},"September":{"rent":{"total": 1248}}},"2020":{"April":{"rent":{"total": 1248}},"February":{"rent":{"total": 1248}},"January":{"rent":{"total": 1248}},"June":{"rent":{"total": 1248}},"March":{"rent":{"total": 1248}},"May":{"rent":{"total": 1248}}}},"state": "CA","uid": "e4yJSk8zRyQD2oIqcBHUFq8EVJm2"}}}}')
var newData = {};

var hash = function(string) {
  var hash = 0, i, chr;
  if (string.length === 0) return hash;
  for (i = 0; i < string.length; i++) {
    chr   = string.charCodeAt(i);
    hash  = ((hash << 5) - hash) + chr;
    hash |= 0;
  }
  return Math.abs(hash);
};

var createEntry = function(entry, tenant, tenantId) {
  var category = (entry.logType === 'Fee' || entry.logType === 'Revenue') ? 'Income' : 'Expense';
  var type = !!entry.type.match(/owner draw/gi) ? 'Owner Draw' : !!entry.type.match(/loan/gi) ? 'Loan' : !!entry.type.match(/overpayment/gi) ? 'Reimbursement' : !!entry.type.match(/late fee/gi) ? 'Late Fee' : entry.type;
  if (type === 'Misc.') {
    type = !!entry.name.match(/overpayment/gi) ? 'Reimbursement' : !!entry.name.match(/owner draw/gi) ? 'Owner Draw' : !!entry.name.match(/late fee/gi) ? 'Late Fee' : entry.name;
  }
  entry.name.match(/owner draw|late fee|loan/gi) ? entry.name = undefined : undefined;
  var names = /Rebecca Themelis|Vickie Nigra|Vickie Nigra|Rebecca Themelis|Vickie Nigra|Rebecca Themelis|Rebecca Themelis|Rebecca Themelis - December management|Rebecca Themelis|Jessie Sanchez|Rosa Alvarez|Sonia Lopez|Leah Magellanes|Kevin Simon|Kathleen Dornidon|Kevin Simon|Ricardo Perez|Mary Texidor|Maria rousey|Mia Hernandez|Byron Sanchez|Vindy Duran|Corbett and Maria Rousey|Brooke Morgan|Javier Garcia|Rebecca Themelis|Ronda Covarrubias|Selene Garcia|Daniel Wegerer|Rebecca Themelis|Tyler Sandness|Leo Santoyo|Rebecca Themelis|Candice Nigra/gi;
  var name = entry.name && !!entry.name.match(names) ? undefined : entry.name;
  var dateParts = entry.date.split('-');
  var transactor = tenant ? tenant.name : entry.name && !entry.name.match(names) ? undefined : entry.name;
  return {
    oldId: accountId,
    category: category,
    type: type,
    name: name,
    amount: entry.amount,
    source: undefined,
    number: undefined,
    description: undefined,
    transactor: transactor,
    tenantId: tenantId,
    recordId: undefined,
    date: {
      year: dateParts[0] ? dateParts[0].trim() : undefined,
      month: dateParts[1] ? dateParts[1].trim() : undefined,
      day: dateParts[2] ? dateParts[2].trim() : undefined,
    },
  }
}

var getRecordIds = function(propertyId, oldId, dateParts) {
  var property = newData[propertyId];
  for (var id in property.account.records) {
    var record = property.account.records[id];
    if (record.oldId === oldId && record.date.due.year === dateParts[0] && record.date.due.month === dateParts[1]) {
      return { record: id, tenant: record.tenantId };
    }
  }
}

var monthCodes = {
  January: '01',
  February: '02',
  March: '03',
  April: '04',
  May: '05',
  June: '06',
  July: '07',
  August: '08',
  September: '09',
  October: '10',
  November: '11',
  December: '12',
}

var entryIds = []

for (var address in oldData) {
  var city = oldData[address].building.city;
  var state = oldData[address].building.state;
  var addressString = [address, city, state].join(',');
  var propertyId = hash(addressString).toString();
  newData[propertyId] = {
    propertyInfo: {
      address: address,
      city: city,
      state: state,
      zip: undefined,
    },
    tenants: {},
    account: {
      entries: {},
      records: {},
    }
  }

  var entries = {};
  var completedEntries = [];
  for (var tenantOldId in oldData[address].residents) {
    var tenant = oldData[address].residents[tenantOldId];
    var email = tenant.email === 'n/a' ? undefined : tenant.email;
    var phone = tenant.phone === 'n/a' ? undefined : tenant.phone;
    var tenantString = [tenant.name, propertyId].join(',');
    var tenantId = hash(tenantString).toString();

    var rentHistory = {};
    for (var year in oldData[address].residents[tenantOldId].rentHistory) {
      for (var MMMM in oldData[address].residents[tenantOldId].rentHistory[year]) {
        var month = monthCodes[MMMM];
        var total = oldData[address].residents[tenantOldId].rentHistory[year][MMMM].rent.total;
        rentHistory[year] = rentHistory[year] || {};
        rentHistory[year][month] = {
          due: total,
        }
        if (oldData[address].residents[tenantOldId].rentHistory[year][MMMM].adjustments) {
          for (var accountId in oldData[address].residents[tenantOldId].rentHistory[year][MMMM].adjustments) {
            var entry = oldData[address].accounts[accountId];
            var entryId = hash([entry.logType, accountId, entry.date, entry.amount].join(','));
            completedEntries.push(accountId);
            entries[entryId] = createEntry(entry, tenant, tenantId);
          }
        }

        var recordId = hash(['Rent', tenantId, year, month, total].join(','));
        newData[propertyId].account.records[recordId] = {
          oldId: tenant.id,
          category: 'Invoice',
          type: 'Rent',
          name: undefined,
          amount: total,
          number: undefined,
          description: undefined,
          transactor: tenant.name,
          tenantId: tenantId,
          date: {
            requested: {
              year: undefined,
              month: undefined,
              day: undefined,
            },
            due: {
              year: year.trim(),
              month: month.trim(),
              day: undefined,
            },
          },
        }
      }
    }

    var leaseStartParts = tenant["lease start"].split('-');
    var leaseEndParts = tenant["lease end"].split('-');
    newData[propertyId].tenants[tenantId] = {
      tenantInfo: {
        oldId: tenant.id,
        name: tenant.name,
        email: email,
        phone: phone,
        unit: tenant.unit,
        currentRent: rentHistory['2020']['03'].due,
        lease: {
          start: {
            "year": leaseStartParts[0] ? leaseStartParts[0].trim : undefined,
            "month": leaseStartParts[1] ? leaseStartParts[1].trim : undefined,
            "day": leaseStartParts[2] ? leaseStartParts[2].trim : undefined,
          },
          end: {
            "year": leaseEndParts[0] ? leaseEndParts[0].trim() : undefined,
            "month": leaseEndParts[1] ? leaseEndParts[1].trim() : undefined,
            "day": leaseEndParts[2] ? leaseEndParts[2].trim() : undefined,
          },
        },
      },
    }
  }

  for (var accountId in oldData[address].accounts) {
    if (completedEntries.includes(accountId)) continue;
    var entry = oldData[address].accounts[accountId];
    var entryId = hash([entry.logType, entry.date, entry.amount].join(','));
    entryIds.push(entryId)
    entries[entryId] = createEntry(entry);
  }

  for (var paymentId in oldData[address].payments) {
    var payment = oldData[address].payments[paymentId];
    for (var paymentDate in payment) {
      var amount = payment[paymentDate];
      var entryId = hash(['Rent', paymentId, paymentDate, amount].join(','));
      entryIds.push(entryId)
      var hasPaymentInfo = oldData[address].paymentsInfo && oldData[address].paymentsInfo[paymentId] && oldData[address].paymentsInfo[paymentId][paymentDate];
      var source = hasPaymentInfo ? oldData[address].paymentsInfo[paymentId][paymentDate].source : oldData[address].residents[paymentId].mobile === 'yes' ? 'Mobile' : 'Other';
      var description = hasPaymentInfo ? oldData[address].paymentsInfo[paymentId][paymentDate].description : undefined;
      var number = undefined;
      if (description && !!description.match(/^\d+$/)) {
        number = description;
        description = undefined;
      }
      var dateParts = paymentDate.split('-');
      var ids = getRecordIds(propertyId, paymentId, dateParts);
      entries[entryId] = {
        oldId: paymentId,
        category: 'Income',
        type: 'Rent',
        name: undefined,
        amount: amount,
        source: source,
        number: number,
        description: description,
        transactor: oldData[address].residents[paymentId].name,
        tenantId: ids.tenant,
        recordId: ids.record,
        date: {
          year: dateParts[0] ? dateParts[0].trim() : undefined,
          month: dateParts[1] ? dateParts[1].trim() : undefined,
          day: dateParts[2] ? dateParts[2].trim() : undefined,
        },
      }
    }
  }
  newData[propertyId].account.entries = entries;
}

for (var propertyId in newData) {
  var property = newData[propertyId];
  var account = property.account;
  var entries = account.entries;
  var rents = {};
  var fees = {};
  var reimbursements = {};
  for (var entryId in entries) {
    var entry = entries[entryId];
    if (entry.category === 'Income') {
      if (entry.type === 'Rent') {
        rents[entryId] = entry;
      }
      if (entry.type === 'Late Fee') {
        fees[entryId] = entry;
      }
    }
    if (entry.category === 'Expense') {
      if (entry.type === 'Reimbursement') {
        reimbursements[entryId] = entry;
      }
    }
  }
  if (fees) {
    for (var feeId in fees) {
      var fee = fees[feeId];
      for (var rentId in rents) {
        var rent = rents[rentId];
        if (fee.tenantId === rent.tenantId && fee.date.year === rent.date.year && fee.date.month === rent.date.month) {
          newData[propertyId].account.entries[rentId].amount = rent.amount - fee.amount;
        }
      }
    }
  }
  if (reimbursements) {
    for (var reimbursementId in reimbursements) {
      var reimbursement = reimbursements[reimbursementId];
      for (var rentId in rents) {
        var rent = rents[rentId];
        if (reimbursement.tenantId === rent.tenantId && reimbursement.date.year === rent.date.year && reimbursement.date.month === rent.date.month) {
          newData[propertyId].account.entries[rentId].amount = rent.amount + reimbursement.amount;
        }
      }
    }
  }
}

var properties = []
var tenants = []
var entries = []
var records = []
for (var propertyId in newData) {
  var property = newData[propertyId];
  property.id = parseInt(propertyId);
  property.propertyInfo.line1 = property.propertyInfo.address;
  property.address = property.propertyInfo;
  var tenantIds = [];
  for (var tenantId in property.tenants) {
    var tenant = property.tenants[tenantId];
    tenant.id = parseInt(tenantId);
    tenant.name = tenant.tenantInfo.name;
    tenant.email = tenant.tenantInfo.email;
    tenant.phone = tenant.tenantInfo.phone;
    tenant.unit = tenant.tenantInfo.unit;
    tenant.currentRent = tenant.tenantInfo.currentRent;
    leaseStartYear = parseInt(tenant.tenantInfo.lease.start.year);
    leaseStartMonth = parseInt(tenant.tenantInfo.lease.start.month) - 1;
    leaseStartDay = parseInt(tenant.tenantInfo.lease.start.day);
    tenant.leaseStart = leaseStartYear && leaseStartMonth > -1 && leaseStartDay ? new Date(leaseStartYear, leaseStartMonth, leaseStartDay).toISOString() : undefined;
    leaseEndYear = parseInt(tenant.tenantInfo.lease.end.year);
    leaseEndMonth = parseInt(tenant.tenantInfo.lease.end.month) - 1;
    leaseEndDay = parseInt(tenant.tenantInfo.lease.end.day);
    tenant.leaseEnd = leaseEndYear && leaseEndMonth > -1 && leaseEndDay ? new Date(leaseEndYear, leaseEndMonth, leaseEndDay).toISOString() : undefined;
    tenant.property = parseInt(propertyId);
    delete tenant.tenantInfo;
    delete tenant.oldId;
    tenantIds.push(parseInt(tenantId));
    tenants.push(tenant);
  }
  var entryIds = [];
  for (var entryId in property.account.entries) {
    var entry = property.account.entries[entryId];
    entry.id = parseInt(entryId);
    entry.tenant = parseInt(entry.tenantId);
    entry.record = parseInt(entry.recordId);
    entry.property = parseInt(propertyId);
    year = parseInt(entry.date.year);
    month = parseInt(entry.date.month) - 1;
    day = parseInt(entry.date.day);
    entry.date = year && month > -1 && day ? new Date(year, month, day).toISOString() : year && month > -1 ? new Date(year, month).toISOString() : undefined;
    delete entry.tenantId;
    delete entry.recordId;
    delete entry.oldId;
    entryIds.push(parseInt(entryId));
    entries.push(entry);
  }
  var recordIds = [];
  for (var recordId in property.account.records) {
    var record = property.account.records[recordId];
    record.id = parseInt(recordId);
    record.tenant = parseInt(record.tenantId);
    record.property = parseInt(propertyId);
    year = parseInt(record.date.due.year);
    month = parseInt(record.date.due.month) - 1;
    day = parseInt(record.date.due.day);
    record.date = year && month > -1 && day ? new Date(year, month, day).toISOString() : year && month > -1 ? new Date(year, month).toISOString() : undefined;
    delete record.tenantId;
    delete record.recordId;
    delete record.oldId;
    recordIds.push(parseInt(recordId));
    records.push(record)
  }
  property.tenants = tenantIds;
  property.entries = entryIds;
  property.records = recordIds;
  delete property.account;
  delete property.propertyInfo.address;
  delete property.propertyInfo;
  properties.push(property);
  delete newData[propertyId];
}
newData.properties = properties;
newData.tenants = tenants;
newData.entries = entries;
newData.records = records;

var getEntries = (propertyId, tenantId) => {
  var entries = [];
  for (var i = 0; i < newData.entries.length; i++) {
    var entry = newData.entries[i];
    if (entry.property === propertyId && entry.tenant === tenantId) entries.push(entry.id);
  }
  return entries;
}

var getRecords = (propertyId, tenantId) => {
  var records = [];
  for (var i = 0; i < newData.records.length; i++) {
    var record = newData.records[i];
    if (record.property === propertyId && record.tenant === tenantId) records.push(record.id);
  }
  return records;
}

var units = [];
var people = [];
var tenants = [];
for (var i = 0; i < newData.tenants.length; i++) {
  var tenant = newData.tenants[i];
  var tenantId = hash(tenant.id.toString() + tenant.name);
  var unitId = hash(tenant.id.toString() + (tenant.unit ? tenant.unit : ''));
  // Need to add unit Ids to building
  units.push({
    id: unitId,
    name: tenant.unit,
    tenants: [tenantId],
    building: tenant.property,
  });
  tenants.push({
    id: tenantId,
    unit: unitId,
    person: tenant.id,
    currentRent: tenant.currentRent,
    leaseEnd: tenant.leaseEnd,
  });
  people.push({
    id: tenant.id,
    name: tenant.name,
    email: tenant.email,
    phone: tenant.phone,
    entries: getEntries(tenant.property, tenant.id),
    records: getRecords(tenant.property, tenant.id),
  });
}
newData.units = units;
newData.people = people;
newData.tenants = tenants;

var getUnits = (id) => {
  var units = [];
  for (var i = 0; i < newData.units.length; i++) {
    var unit = newData.units[i];
    if (unit.building === id) units.push(unit.id);
  }
  return units;
}

var properties = [];
var buildings = [];
var didColorado = false;
for (var i = 0; i < newData.properties.length; i++) {
  var building = newData.properties[i];
  var property = {};
  if (building.address.line1.match(/colorado boulevard/ig)) {
    building.property = 918976025;
    building.units = [];
    building.units = getUnits(building.id);
    delete building.tenants;
    delete building.records;
    delete building.entries;
    buildings.push(building);
    if (didColorado) continue;
    property.name = 'Colorado Boulevard';
    property.buildings = [906979123, 1169268374, 1437687918, 1625037383];
    property.id = 918976025;
    didColorado = true;
  } else {
    property.name = building.address.line1;
    property.buildings = [building.id];
    property.id = hash(property.name);
    building.property = property.id;
    building.units = getUnits(building.id);
    delete building.tenants;
    delete building.records;
    delete building.entries;
    buildings.push(building);
  }
  properties.push(property);
}
newData.properties = properties;
newData.buildings = buildings;

newData.owners = [
  {
    id: 445890682,
    person: 742965617,
    properties: [1475544782]
  },
  {
    id: 1320821815,
    person: hash('Vickie Nigra' + '2vickie@charter.net'),
    properties: [918976025, 1604067203, 936057677]
  },
];

newData.people.push({
  id: hash('Vickie Nigra' + '2vickie@charter.net'),
  name: 'Vickie Nigra',
  email: '2vickie@charter.net',
})

for (var property of newData.properties) {
  if (property.name.match(/denker/ig)) {
    property.owner = 445890682
  } else {
    property.owner = 1320821815
  }
}

var getOwner = (id) => {
  for (var building of newData.buildings) {
    if (building.id === id) {
      for (var property of newData.properties) {
        if (property.id === building.property) return property.owner;
      }
    }
  }
}

for (var record of newData.records) {
  record.person = record.tenant;
  delete record.tenant;
  delete record.property;
}

for (var entry of newData.entries) {
  if (entry.tenant) {
    entry.person = entry.tenant;
  } else {
    entry.person = getOwner(entry.property);
  }
  delete entry.tenant;
  delete entry.property;
}

// Remove Unnecessary Child IDs

for (var owner of newData.owners) {
  owner.personId = owner.person
  delete owner.person
  delete owner.properties
}

for (var property of newData.properties) {
  property.ownerId = property.owner
  delete property.owner
  delete property.buildings
}

for (var building of newData.buildings) {
  building.propertyId = building.property
  delete building.property
  delete building.units
}

for (var unit of newData.units) {
  unit.buildingId = unit.building
  delete unit.building
  delete unit.tenants
}

for (var tenant of newData.tenants) {
  tenant.personId = tenant.person
  tenant.unitId = tenant.unit
  delete tenant.person
  delete tenant.unit
}

for (var person of newData.people) {
  delete person.entries
  delete person.records
}

for (var entry of newData.entries) {
  entry.recordId = entry.record
  entry.personId = entry.person
  delete entry.record
  delete entry.person
}

for (var record of newData.records) {
  record.personId = record.person
  delete record.person
}

for (var record of newData.records) {
  if (record.personId === 1320821815 || record.personId === 445890682) record.personId = 742965617
}

for (var entry of newData.entries) {
  if (entry.personId === 1320821815 || entry.personId === 445890682) entry.personId = 742965617
}
